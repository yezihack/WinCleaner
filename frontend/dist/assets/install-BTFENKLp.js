import{a2 as N,aK as Ae,h as Le,a4 as Ie,k as Be,aF as De,aL as xe,aM as ge,m as Ne,aN as Fe,aO as Xe,z as je,V as ce,w as te,aP as Ze,ao as Oe,aQ as qe,aR as $e,_ as pe,aS as Ve,y as He,aT as Je,ax as Ke,Z as Qe,j as Z,aU as re,ab as ue,a9 as we,aa as We,av as ea,ag as aa,af as ta,ac as ra,aV as na,aW as ia,aX as la,aY as oa,g as Me,J as Ge,aZ as sa,a_ as va,a$ as ga,a6 as ca,b0 as ua,b1 as fa}from"./index-DWTZmJt_.js";function Re(a,t,n,e,i,l,r,o){var c=i-a,u=l-t,s=n-a,d=e-t,f=Math.sqrt(s*s+d*d);s/=f,d/=f;var g=c*s+u*d,v=g/f;v*=f;var h=r[0]=a+v*s,p=r[1]=t+v*d;return Math.sqrt((h-i)*(h-i)+(p-l)*(p-l))}var F=new N,L=new N,I=new N,X=new N,z=new N,ie=[],G=new N;function ha(a,t){if(t<=180&&t>0){t=t/180*Math.PI,F.fromArray(a[0]),L.fromArray(a[1]),I.fromArray(a[2]),N.sub(X,F,L),N.sub(z,I,L);var n=X.len(),e=z.len();if(!(n<.001||e<.001)){X.scale(1/n),z.scale(1/e);var i=X.dot(z),l=Math.cos(t);if(l<i){var r=Re(L.x,L.y,I.x,I.y,F.x,F.y,ie);G.fromArray(ie),G.scaleAndAdd(z,r/Math.tan(Math.PI-t));var o=I.x!==L.x?(G.x-L.x)/(I.x-L.x):(G.y-L.y)/(I.y-L.y);if(isNaN(o))return;o<0?N.copy(G,L):o>1&&N.copy(G,I),G.toArray(a[1])}}}}function pa(a,t,n){if(n<=180&&n>0){n=n/180*Math.PI,F.fromArray(a[0]),L.fromArray(a[1]),I.fromArray(a[2]),N.sub(X,L,F),N.sub(z,I,L);var e=X.len(),i=z.len();if(!(e<.001||i<.001)){X.scale(1/e),z.scale(1/i);var l=X.dot(t),r=Math.cos(n);if(l<r){var o=Re(L.x,L.y,I.x,I.y,F.x,F.y,ie);G.fromArray(ie);var c=Math.PI/2,u=Math.acos(z.dot(t)),s=c+u-n;if(s>=c)N.copy(G,I);else{G.scaleAndAdd(z,o/Math.tan(Math.PI/2-s));var d=I.x!==L.x?(G.x-L.x)/(I.x-L.x):(G.y-L.y)/(I.y-L.y);if(isNaN(d))return;d<0?N.copy(G,L):d>1&&N.copy(G,I)}G.toArray(a[1])}}}}function fe(a,t,n,e){var i=n==="normal",l=i?a:a.ensureState(n);l.ignore=t;var r=e.get("smooth");r&&r===!0&&(r=.3),l.shape=l.shape||{},r>0&&(l.shape.smooth=r);var o=e.getModel("lineStyle").getLineStyle();i?a.useStyle(o):l.style=o}function da(a,t){var n=t.smooth,e=t.points;if(e)if(a.moveTo(e[0][0],e[0][1]),n>0&&e.length>=3){var i=xe(e[0],e[1]),l=xe(e[1],e[2]);if(!i||!l){a.lineTo(e[1][0],e[1][1]),a.lineTo(e[2][0],e[2][1]);return}var r=Math.min(i,l)*n,o=ge([],e[1],e[0],r/i),c=ge([],e[1],e[2],r/l),u=ge([],o,c,.5);a.bezierCurveTo(o[0],o[1],o[0],o[1],u[0],u[1]),a.bezierCurveTo(c[0],c[1],c[0],c[1],e[2][0],e[2][1])}else for(var s=1;s<e.length;s++)a.lineTo(e[s][0],e[s][1])}function ma(a,t,n){var e=a.getTextGuideLine(),i=a.getTextContent();if(!i){e&&a.removeTextGuideLine();return}for(var l=t.normal,r=l.get("show"),o=i.ignore,c=0;c<Ae.length;c++){var u=Ae[c],s=t[u],d=u==="normal";if(s){var f=s.get("show"),g=d?o:Le(i.states[u]&&i.states[u].ignore,o);if(g||!Le(f,r)){var v=d?e:e&&e.states[u];v&&(v.ignore=!0),e&&fe(e,!0,u,s);continue}e||(e=new Ie,a.setTextGuideLine(e),!d&&(o||!r)&&fe(e,!0,"normal",t.normal),a.stateProxy&&(e.stateProxy=a.stateProxy)),fe(e,!1,u,s)}}if(e){Be(e.style,n),e.style.fill=null;var h=l.get("showAbove"),p=a.textGuideLineConfig=a.textGuideLineConfig||{};p.showAbove=h||!1,e.buildPath=da}}function ya(a,t){t=t||"labelLine";for(var n={normal:a.getModel(t)},e=0;e<De.length;e++){var i=De[e];n[i]=a.getModel([i,t])}return n}var Te=Math.PI*2,ne=Math.PI/180;function ba(a,t,n){t.eachSeriesByType(a,function(e){var i=e.getData(),l=i.mapDimension("value"),r=Fe(e,n),o=r.cx,c=r.cy,u=r.r,s=r.r0,d=r.viewRect,f=-e.get("startAngle")*ne,g=e.get("endAngle"),v=e.get("padAngle")*ne;g=g==="auto"?f-Te:-g*ne;var h=e.get("minAngle")*ne,p=h+v,y=0;i.each(l,function(V){!isNaN(V)&&y++});var S=i.getSum(l),b=Math.PI/(S||y)*2,M=e.get("clockwise"),D=e.get("roseType"),T=e.get("stillShowZeroSum"),O=i.getDataExtent(l);O[0]=0;var m=M?1:-1,x=[f,g],E=m*v/2;Xe(x,!M),f=x[0],g=x[1];var U=Ee(e);U.startAngle=f,U.endAngle=g,U.clockwise=M,U.cx=o,U.cy=c,U.r=u,U.r0=s;var Y=Math.abs(g-f),_=Y,q=0,k=f;if(i.setLayout({viewRect:d,r:u}),i.each(l,function(V,R){var A;if(isNaN(V)){i.setItemLayout(R,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:M,cx:o,cy:c,r0:s,r:D?NaN:u});return}D!=="area"?A=S===0&&T?b:V*b:A=Y/y,A<p?(A=p,_-=p):q+=V;var C=k+m*A,P=0,w=0;v>A?(P=k+m*A/2,w=P):(P=k+E,w=C-E),i.setItemLayout(R,{angle:A,startAngle:P,endAngle:w,clockwise:M,cx:o,cy:c,r0:s,r:D?je(V,O,[s,u]):u}),k=C}),_<Te&&y)if(_<=.001){var B=Y/y;i.each(l,function(V,R){if(!isNaN(V)){var A=i.getItemLayout(R);A.angle=B;var C=0,P=0;B<v?(C=f+m*(R+1/2)*B,P=C):(C=f+m*R*B+E,P=f+m*(R+1)*B-E),A.startAngle=C,A.endAngle=P}})}else b=_/q,k=f,i.each(l,function(V,R){if(!isNaN(V)){var A=i.getItemLayout(R),C=A.angle===p?p:V*b,P=0,w=0;C<v?(P=k+m*C/2,w=P):(P=k+E,w=k+m*C-E),A.startAngle=P,A.endAngle=w,k+=m*C}})})}var Ee=Ne();function Sa(a){return{seriesType:a,reset:function(t,n){var e=n.findComponents({mainType:"legend"});if(!(!e||!e.length)){var i=t.getData();i.filterSelf(function(l){for(var r=i.getName(l),o=0;o<e.length;o++)if(!e[o].isSelected(r))return!1;return!0})}}}}var Aa=Math.PI/180;function Pe(a,t,n,e,i,l,r,o,c,u){if(a.length<2)return;function s(h){for(var p=h.rB,y=p*p,S=0;S<h.list.length;S++){var b=h.list[S],M=Math.abs(b.label.y-n),D=e+b.len,T=D*D,O=Math.sqrt(Math.abs((1-M*M/y)*T)),m=t+(O+b.len2)*i,x=m-b.label.x,E=b.targetTextWidth-x*i;ke(b,E,!0),b.label.x=m}}function d(h){for(var p={list:[],maxY:0},y={list:[],maxY:0},S=0;S<h.length;S++)if(h[S].labelAlignTo==="none"){var b=h[S],M=b.label.y>n?y:p,D=Math.abs(b.label.y-n);if(D>=M.maxY){var T=b.label.x-t-b.len2*i,O=e+b.len,m=Math.abs(T)<O?Math.sqrt(D*D/(1-T*T/O/O)):O;M.rB=m,M.maxY=D}M.list.push(b)}s(p),s(y)}for(var f=a.length,g=0;g<f;g++)if(a[g].position==="outer"&&a[g].labelAlignTo==="labelLine"){var v=a[g].label.x-u;a[g].linePoints[1][0]+=v,a[g].label.x=u}$e(a,1,c,c+r)&&d(a)}function La(a,t,n,e,i,l,r,o){for(var c=[],u=[],s=Number.MAX_VALUE,d=-Number.MAX_VALUE,f=0;f<a.length;f++){var g=a[f].label;he(a[f])||(g.x<t?(s=Math.min(s,g.x),c.push(a[f])):(d=Math.max(d,g.x),u.push(a[f])))}for(var f=0;f<a.length;f++){var v=a[f];if(!he(v)&&v.linePoints){if(v.labelStyleWidth!=null)continue;var g=v.label,h=v.linePoints,p=void 0;v.labelAlignTo==="edge"?g.x<t?p=h[2][0]-v.labelDistance-r-v.edgeDistance:p=r+i-v.edgeDistance-h[2][0]-v.labelDistance:v.labelAlignTo==="labelLine"?g.x<t?p=s-r-v.bleedMargin:p=r+i-d-v.bleedMargin:g.x<t?p=g.x-r-v.bleedMargin:p=r+i-g.x-v.bleedMargin,v.targetTextWidth=p,ke(v,p,!1)}}Pe(u,t,n,e,1,i,l,r,o,d),Pe(c,t,n,e,-1,i,l,r,o,s);for(var f=0;f<a.length;f++){var v=a[f];if(!he(v)&&v.linePoints){var g=v.label,h=v.linePoints,y=v.labelAlignTo==="edge",S=g.style.padding,b=S?S[1]+S[3]:0,M=g.style.backgroundColor?0:b,D=v.rect.width+M,T=h[1][0]-h[2][0];y?g.x<t?h[2][0]=r+v.edgeDistance+D+v.labelDistance:h[2][0]=r+i-v.edgeDistance-D-v.labelDistance:(g.x<t?h[2][0]=g.x+v.labelDistance:h[2][0]=g.x-v.labelDistance,h[1][0]=h[2][0]+T),h[1][1]=h[2][1]=g.y}}}function ke(a,t,n){if(a.labelStyleWidth==null){var e=a.label,i=e.style,l=a.rect,r=i.backgroundColor,o=i.padding,c=o?o[1]+o[3]:0,u=i.overflow,s=l.width+(r?0:c);if(t<s||n){if(u&&u.match("break")){e.setStyle("backgroundColor",null),e.setStyle("width",t-c);var d=e.getBoundingRect();e.setStyle("width",Math.ceil(d.width)),e.setStyle("backgroundColor",r)}else{var f=t-c,g=t<s?f:n?f>a.unconstrainedWidth?null:f:null;e.setStyle("width",g)}_e(l,e)}}}function _e(a,t){Ce.rect=a,qe(Ce,t,Da)}var Da={minMarginForce:[null,0,null,0],marginDefault:[1,0,1,0]},Ce={};function he(a){return a.position==="center"}function xa(a){var t=a.getData(),n=[],e,i,l=!1,r=(a.get("minShowLabelAngle")||0)*Aa,o=t.getLayout("viewRect"),c=t.getLayout("r"),u=o.width,s=o.x,d=o.y,f=o.height;function g(T){T.ignore=!0}function v(T){if(!T.ignore)return!0;for(var O in T.states)if(T.states[O].ignore===!1)return!0;return!1}t.each(function(T){var O=t.getItemGraphicEl(T),m=O.shape,x=O.getTextContent(),E=O.getTextGuideLine(),U=t.getItemModel(T),Y=U.getModel("label"),_=Y.get("position")||U.get(["emphasis","label","position"]),q=Y.get("distanceToLabelLine"),k=Y.get("alignTo"),B=ce(Y.get("edgeDistance"),u),V=Y.get("bleedMargin");V==null&&(V=Math.min(u,f)>200?10:2);var R=U.getModel("labelLine"),A=R.get("length");A=ce(A,u);var C=R.get("length2");if(C=ce(C,u),Math.abs(m.endAngle-m.startAngle)<r){te(x.states,g),x.ignore=!0,E&&(te(E.states,g),E.ignore=!0);return}if(v(x)){var P=(m.startAngle+m.endAngle)/2,w=Math.cos(P),j=Math.sin(P),K,ee,de,ae;e=m.cx,i=m.cy;var $=_==="inside"||_==="inner";if(_==="center")K=m.cx,ee=m.cy,ae="center";else{var le=($?(m.r+m.r0)/2*w:m.r*w)+e,oe=($?(m.r+m.r0)/2*j:m.r*j)+i;if(K=le+w*3,ee=oe+j*3,!$){var me=le+w*(A+c-m.r),ye=oe+j*(A+c-m.r),be=me+(w<0?-1:1)*C,Se=ye;k==="edge"?K=w<0?s+B:s+u-B:K=be+(w<0?-q:q),ee=Se,de=[[le,oe],[me,ye],[be,Se]]}ae=$?"center":k==="edge"?w>0?"right":"left":w>0?"left":"right"}var Q=Math.PI,H=0,W=Y.get("rotate");if(Oe(W))H=W*(Q/180);else if(_==="center")H=0;else if(W==="radial"||W===!0){var Ye=w<0?-P+Q:-P;H=Ye}else if(W==="tangential"&&_!=="outside"&&_!=="outer"){var J=Math.atan2(w,j);J<0&&(J=Q*2+J);var ze=j>0;ze&&(J=Q+J),H=J-Q}if(l=!!H,x.x=K,x.y=ee,x.rotation=H,x.setStyle({verticalAlign:"middle"}),$){x.setStyle({align:ae});var ve=x.states.select;ve&&(ve.x+=x.x,ve.y+=x.y)}else{var se=new Ze(0,0,0,0);_e(se,x),n.push({label:x,labelLine:E,position:_,len:A,len2:C,minTurnAngle:R.get("minTurnAngle"),maxSurfaceAngle:R.get("maxSurfaceAngle"),surfaceNormal:new N(w,j),linePoints:de,textAlign:ae,labelDistance:q,labelAlignTo:k,edgeDistance:B,bleedMargin:V,rect:se,unconstrainedWidth:se.width,labelStyleWidth:x.style.width})}O.setTextConfig({inside:$})}}),!l&&a.get("avoidLabelOverlap")&&La(n,e,i,c,u,f,s,d);for(var h=0;h<n.length;h++){var p=n[h],y=p.label,S=p.labelLine,b=isNaN(y.x)||isNaN(y.y);if(y){y.setStyle({align:p.textAlign}),b&&(te(y.states,g),y.ignore=!0);var M=y.states.select;M&&(M.x+=y.x,M.y+=y.y)}if(S){var D=p.linePoints;b||!D?(te(S.states,g),S.ignore=!0):(ha(D,p.minTurnAngle),pa(D,p.surfaceNormal,p.maxSurfaceAngle),S.setShape({points:D}),y.__hostTarget.textGuideLineConfig={anchor:new N(D[0][0],D[0][1])})}}}var wa=function(a){pe(t,a);function t(n,e,i){var l=a.call(this)||this;l.z2=2;var r=new Qe;return l.setTextContent(r),l.updateData(n,e,i,!0),l}return t.prototype.updateData=function(n,e,i,l){var r=this,o=n.hostModel,c=n.getItemModel(e),u=c.getModel("emphasis"),s=n.getItemLayout(e),d=Z(re(c.getModel("itemStyle"),s,!0),s);if(isNaN(d.startAngle)){r.setShape(d);return}if(l){r.setShape(d);var f=o.getShallow("animationType");o.ecModel.ssr?(ue(r,{scaleX:0,scaleY:0},o,{dataIndex:e,isFrom:!0}),r.originX=d.cx,r.originY=d.cy):f==="scale"?(r.shape.r=s.r0,ue(r,{shape:{r:s.r}},o,e)):i!=null?(r.setShape({startAngle:i,endAngle:i}),ue(r,{shape:{startAngle:s.startAngle,endAngle:s.endAngle}},o,e)):(r.shape.endAngle=s.startAngle,we(r,{shape:{endAngle:s.endAngle}},o,e))}else We(r),we(r,{shape:d},o,e);r.useStyle(n.getItemVisual(e,"style")),ea(r,c);var g=(s.startAngle+s.endAngle)/2,v=o.get("selectedOffset"),h=Math.cos(g)*v,p=Math.sin(g)*v,y=c.getShallow("cursor");y&&r.attr("cursor",y),this._updateLabel(o,n,e),r.ensureState("emphasis").shape=Z({r:s.r+(u.get("scale")&&u.get("scaleSize")||0)},re(u.getModel("itemStyle"),s)),Z(r.ensureState("select"),{x:h,y:p,shape:re(c.getModel(["select","itemStyle"]),s)}),Z(r.ensureState("blur"),{shape:re(c.getModel(["blur","itemStyle"]),s)});var S=r.getTextGuideLine(),b=r.getTextContent();S&&Z(S.ensureState("select"),{x:h,y:p}),Z(b.ensureState("select"),{x:h,y:p}),aa(this,u.get("focus"),u.get("blurScope"),u.get("disabled"))},t.prototype._updateLabel=function(n,e,i){var l=this,r=e.getItemModel(i),o=r.getModel("labelLine"),c=e.getItemVisual(i,"style"),u=c&&c.fill,s=c&&c.opacity;ta(l,ra(r),{labelFetcher:e.hostModel,labelDataIndex:i,inheritColor:u,defaultOpacity:s,defaultText:n.getFormattedLabel(i,"normal")||e.getName(i)});var d=l.getTextContent();l.setTextConfig({position:null,rotation:null}),d.attr({z2:10});var f=r.get(["label","position"]);if(f!=="outside"&&f!=="outer")l.removeTextGuideLine();else{var g=this.getTextGuideLine();g||(g=new Ie,this.setTextGuideLine(g)),ma(this,ya(r),{stroke:u,opacity:na(o.get(["lineStyle","opacity"]),s,1)})}},t}(Ve),Ma=function(a){pe(t,a);function t(){var n=a!==null&&a.apply(this,arguments)||this;return n.ignoreLabelLineUpdate=!0,n}return t.prototype.render=function(n,e,i,l){var r=n.getData(),o=this._data,c=this.group,u;if(!o&&r.count()>0){for(var s=r.getItemLayout(0),d=1;isNaN(s&&s.startAngle)&&d<r.count();++d)s=r.getItemLayout(d);s&&(u=s.startAngle)}if(this._emptyCircleSector&&c.remove(this._emptyCircleSector),r.count()===0&&n.get("showEmptyCircle")){var f=Ee(n),g=new Ve({shape:He(f)});g.useStyle(n.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=g,c.add(g)}r.diff(o).add(function(v){var h=new wa(r,v,u);r.setItemGraphicEl(v,h),c.add(h)}).update(function(v,h){var p=o.getItemGraphicEl(h);p.updateData(r,v,u),p.off("click"),c.add(p),r.setItemGraphicEl(v,p)}).remove(function(v){var h=o.getItemGraphicEl(v);Je(h,n,v)}).execute(),xa(n),n.get("animationTypeUpdate")!=="expansion"&&(this._data=r)},t.prototype.dispose=function(){},t.prototype.containPoint=function(n,e){var i=e.getData(),l=i.getItemLayout(0);if(l){var r=n[0]-l.cx,o=n[1]-l.cy,c=Math.sqrt(r*r+o*o);return c<=l.r&&c>=l.r0}},t.type="pie",t}(Ke);function Ta(a,t,n){t=ia(t)&&{coordDimensions:t}||Z({encodeDefine:a.getEncode()},t);var e=a.getSource(),i=la(e,t).dimensions,l=new oa(i,a);return l.initData(e,n),l}var Pa=function(){function a(t,n){this._getDataWithEncodedVisual=t,this._getRawData=n}return a.prototype.getAllNames=function(){var t=this._getRawData();return t.mapArray(t.getName)},a.prototype.containName=function(t){var n=this._getRawData();return n.indexOfName(t)>=0},a.prototype.indexOfName=function(t){var n=this._getDataWithEncodedVisual();return n.indexOfName(t)},a.prototype.getItemVisual=function(t,n){var e=this._getDataWithEncodedVisual();return e.getItemVisual(t,n)},a}(),Ca=Ne(),Ue=function(a){pe(t,a);function t(){return a!==null&&a.apply(this,arguments)||this}return t.prototype.init=function(n){a.prototype.init.apply(this,arguments),this.legendVisualProvider=new Pa(Me(this.getData,this),Me(this.getRawData,this)),this._defaultLabelLine(n)},t.prototype.mergeOption=function(){a.prototype.mergeOption.apply(this,arguments)},t.prototype.getInitialData=function(){return Ta(this,{coordDimensions:["value"],encodeDefaulter:Ge(sa,this)})},t.prototype.getDataParams=function(n){var e=this.getData(),i=Ca(e),l=i.seats;if(!l){var r=[];e.each(e.mapDimension("value"),function(c){r.push(c)}),l=i.seats=va(r,e.hostModel.get("percentPrecision"))}var o=a.prototype.getDataParams.call(this,n);return o.percent=l[n]||0,o.$vars.push("percent"),o},t.prototype._defaultLabelLine=function(n){ga(n,"labelLine",["show"]);var e=n.labelLine,i=n.emphasis.labelLine;e.show=e.show&&n.label.show,i.show=i.show&&n.emphasis.label.show},t.type="series.pie",t.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"50%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,coordinateSystemUsage:"box",left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:30,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},t}(ca);ua({fullType:Ue.type,getCoord2:function(a){return a.getShallow("center")}});function Ia(a){return{seriesType:a,reset:function(t,n){var e=t.getData();e.filterSelf(function(i){var l=e.mapDimension("value"),r=e.get(l,i);return!(Oe(r)&&!isNaN(r)&&r<0)})}}}function Oa(a){a.registerChartView(Ma),a.registerSeriesModel(Ue),fa("pie",a.registerAction),a.registerLayout(Ge(ba,"pie")),a.registerProcessor(Sa("pie")),a.registerProcessor(Ia("pie"))}export{Oa as i};
