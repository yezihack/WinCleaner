import{d as L,o as E,c as F,a as n,b as t,w as a,e as w,E as f,f as l,r as h,h as $,l as b,u as D,s as I,t as i,p as N,q as z}from"./index-CeN3S9B-.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"process"},U={class:"action-bar"},q={class:"process-count"},G={class:"usage-cell"},S={class:"usage-text"},T={class:"usage-cell"},j={class:"usage-text"},A=L({__name:"Process",setup(H){const p=h(!1),d=h(""),u=h([]),g=N(()=>{const e=d.value.toLowerCase();return e?u.value.filter(o=>o.name.toLowerCase().includes(e)):u.value}),y=e=>{if(e===0)return"0 B";const o=1024,m=["B","KB","MB","GB"],c=Math.floor(Math.log(e)/Math.log(o));return parseFloat((e/Math.pow(o,c)).toFixed(1))+" "+m[c]},k=e=>e<10?"#67c23a":e<50?"#e6a23c":"#f56c6c",C=e=>e<5?"#67c23a":e<20?"#e6a23c":"#f56c6c",_=async()=>{p.value=!0;try{u.value=await w.getProcessList()}catch{f.error("获取进程列表失败")}finally{p.value=!1}},B=async e=>{try{await z.confirm(`确定结束进程 "${e.name}" (PID: ${e.pid})？`,"结束进程",{type:"warning"})}catch{return}try{await w.killProcess(e.pid),f.success(`已结束进程 ${e.name}`),await _()}catch{f.error("结束进程失败，可能权限不足")}};return E(()=>{_()}),(e,o)=>{const m=l("Refresh"),c=l("el-icon"),v=l("el-button"),M=l("el-input"),r=l("el-table-column"),x=l("el-progress"),P=l("el-table"),V=l("el-card");return $(),F("div",R,[o[3]||(o[3]=n("h2",{style:{"margin-bottom":"20px",color:"#303133"}},"进程管理",-1)),t(V,{shadow:"hover"},{default:a(()=>[n("div",U,[t(v,{type:"primary",loading:p.value,onClick:_},{default:a(()=>[t(c,null,{default:a(()=>[t(m)]),_:1}),o[1]||(o[1]=b(" 刷新 ",-1))]),_:1},8,["loading"]),t(M,{modelValue:d.value,"onUpdate:modelValue":o[0]||(o[0]=s=>d.value=s),placeholder:"搜索进程名...",clearable:"",style:{width:"240px"},"prefix-icon":D(I)},null,8,["modelValue","prefix-icon"]),n("span",q,"共 "+i(g.value.length)+" 个进程",1)]),t(P,{data:g.value,style:{"margin-top":"16px"},"max-height":"480","default-sort":{prop:"mem_rss",order:"descending"},stripe:""},{default:a(()=>[t(r,{prop:"pid",label:"PID",width:"80",sortable:""}),t(r,{prop:"name",label:"进程名","min-width":"180",sortable:"","show-overflow-tooltip":""}),t(r,{prop:"cpu_percent",label:"CPU",width:"130",sortable:""},{default:a(({row:s})=>[n("div",G,[t(x,{percentage:Math.min(s.cpu_percent,100),"stroke-width":14,"show-text":!1,color:k(s.cpu_percent),style:{flex:"1"}},null,8,["percentage","color"]),n("span",S,i(s.cpu_percent.toFixed(1))+"%",1)])]),_:1}),t(r,{prop:"mem_rss",label:"内存",width:"180",sortable:""},{default:a(({row:s})=>[n("div",T,[t(x,{percentage:Math.min(s.mem_percent,100),"stroke-width":14,"show-text":!1,color:C(s.mem_percent),style:{flex:"1"}},null,8,["percentage","color"]),n("span",j,i(y(s.mem_rss))+" ("+i(s.mem_percent.toFixed(1))+"%)",1)])]),_:1}),t(r,{prop:"username",label:"用户",width:"100","show-overflow-tooltip":""}),t(r,{label:"操作",width:"80",align:"center"},{default:a(({row:s})=>[t(v,{link:"",type:"danger",size:"small",onClick:J=>B(s)},{default:a(()=>[...o[2]||(o[2]=[b(" 结束 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})])}}}),W=K(A,[["__scopeId","data-v-3919f44d"]]);export{W as default};
