import{d as W,o as j,e as S,c as y,a as s,b as t,w as o,r as c,f as n,h as m,F,k as G,u as z,l as V,t as d,m as q,s as H,p as C,n as L}from"./index-CeN3S9B-.js";import{u as J,i as P,a as Q,b as X,c as Y,d as Z,e as ee,s as D}from"./index-DWTZmJt_.js";import{i as te}from"./install-BTFENKLp.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";const le={class:"disk"},oe={class:"disk-header"},se={class:"disk-drive"},ne={class:"disk-detail"},re={class:"disk-free"},ie={class:"card-header"},ue={class:"header-actions"},de={key:0,style:{"margin-top":"8px",color:"#909399","font-size":"12px"}},pe=W({__name:"Disk",setup(ce){J([P,te,Q,X,Y,Z,ee]);const u=c([]),g=c(!1),f=c("C:\\"),x=c(50),w=c(""),_=c(null),N=l=>l<60?"#67c23a":l<85?"#e6a23c":"#f56c6c",v=l=>{if(!l||l===0)return"0 B";const e=1024,r=["B","KB","MB","GB","TB"],i=Math.floor(Math.log(l)/Math.log(e));return parseFloat((l/Math.pow(e,i)).toFixed(1))+" "+r[i]},k=l=>+(l/1024/1024/1024).toFixed(1),R=C(()=>{var r;const l=((r=_.value)==null?void 0:r.files)||[],e=w.value.toLowerCase();return e?l.filter(i=>i.path.toLowerCase().includes(e)||i.ext.toLowerCase().includes(e)):l}),U=C(()=>{const l=u.value.map(e=>e.mountpoint.replace("\\",""));return{tooltip:{trigger:"axis",formatter:e=>{const r=e[0],i=e[1];return`${r.axisValue}<br/>${r.marker} 已用: ${r.value} GB<br/>${i.marker} 可用: ${i.value} GB`}},legend:{data:["已用","可用"],bottom:0},grid:{left:50,right:20,top:16,bottom:40},xAxis:{type:"category",data:l},yAxis:{type:"value",name:"GB"},series:[{name:"已用",type:"bar",stack:"total",data:u.value.map(e=>k(e.used)),itemStyle:{color:"#409eff",borderRadius:[0,0,0,0]}},{name:"可用",type:"bar",stack:"total",data:u.value.map(e=>k(e.free)),itemStyle:{color:"#e4e7ed",borderRadius:[4,4,0,0]}}]}}),A=C(()=>({tooltip:{trigger:"item",formatter:"{b}: {c} GB ({d}%)"},series:[{type:"pie",radius:["35%","65%"],center:["50%","50%"],itemStyle:{borderRadius:6,borderColor:"#fff",borderWidth:2},label:{show:!0,formatter:`{b}
{d}%`,fontSize:11},data:u.value.map((l,e)=>({value:k(l.used),name:l.mountpoint.replace("\\",""),itemStyle:{color:["#409eff","#67c23a","#e6a23c","#f56c6c","#9b59b6","#1abc9c"][e%6]}}))}]})),K=async()=>{g.value=!0;try{_.value=await S.scanLargeFiles(f.value,x.value)}catch{}finally{g.value=!1}};return j(async()=>{try{u.value=await S.getDiskList(),u.value.length>0&&(f.value=u.value[0].mountpoint)}catch{}}),(l,e)=>{const r=n("el-tag"),i=n("el-progress"),h=n("el-card"),B=n("el-col"),M=n("el-row"),p=n("el-option"),$=n("el-select"),O=n("el-input"),T=n("el-button"),b=n("el-table-column"),E=n("el-table");return m(),y("div",le,[e[7]||(e[7]=s("h2",{style:{"margin-bottom":"20px",color:"#303133"}},"磁盘管理",-1)),t(M,{gutter:16},{default:o(()=>[(m(!0),y(F,null,G(u.value,(a,I)=>(m(),L(B,{span:8,key:I},{default:o(()=>[t(h,{shadow:"hover",class:"disk-card"},{default:o(()=>[s("div",oe,[s("span",se,d(a.mountpoint),1),t(r,{size:"small",type:"info"},{default:o(()=>[V(d(a.fstype),1)]),_:2},1024)]),t(i,{type:"dashboard",percentage:Math.round(a.used_percent),width:120,color:N(a.used_percent)},null,8,["percentage","color"]),s("div",ne,[s("span",null,"已用 "+d(v(a.used)),1),s("span",null,"共 "+d(v(a.total)),1)]),s("div",re,"可用 "+d(v(a.free)),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),t(M,{gutter:16,style:{"margin-top":"16px"}},{default:o(()=>[t(B,{span:14},{default:o(()=>[t(h,{shadow:"hover"},{header:o(()=>[...e[3]||(e[3]=[s("span",null,"分区空间对比",-1)])]),default:o(()=>[t(z(D),{option:U.value,style:{height:"300px"},autoresize:""},null,8,["option"])]),_:1})]),_:1}),t(B,{span:10},{default:o(()=>[t(h,{shadow:"hover"},{header:o(()=>[...e[4]||(e[4]=[s("span",null,"空间占比",-1)])]),default:o(()=>[t(z(D),{option:A.value,style:{height:"300px"},autoresize:""},null,8,["option"])]),_:1})]),_:1})]),_:1}),t(h,{shadow:"hover",style:{"margin-top":"16px"}},{header:o(()=>[s("div",ie,[e[6]||(e[6]=s("span",null,"大文件扫描",-1)),s("div",ue,[t($,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=a=>f.value=a),size:"small",style:{width:"100px"}},{default:o(()=>[(m(!0),y(F,null,G(u.value,a=>(m(),L(p,{key:a.mountpoint,label:a.mountpoint,value:a.mountpoint},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t($,{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=a=>x.value=a),size:"small",style:{width:"120px"}},{default:o(()=>[t(p,{value:10,label:"≥ 10 MB"}),t(p,{value:50,label:"≥ 50 MB"}),t(p,{value:100,label:"≥ 100 MB"}),t(p,{value:500,label:"≥ 500 MB"}),t(p,{value:1024,label:"≥ 1 GB"})]),_:1},8,["modelValue"]),t(O,{modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=a=>w.value=a),placeholder:"搜索文件...",clearable:"",size:"small",style:{width:"180px"},"prefix-icon":z(H)},null,8,["modelValue","prefix-icon"]),t(T,{type:"primary",size:"small",loading:g.value,onClick:K},{default:o(()=>[...e[5]||(e[5]=[V(" 扫描 ",-1)])]),_:1},8,["loading"])])])]),default:o(()=>[t(E,{data:R.value,"default-sort":{prop:"size",order:"descending"},"max-height":"400",stripe:""},{default:o(()=>[t(b,{type:"index",width:"50"}),t(b,{prop:"path",label:"文件路径","min-width":"360","show-overflow-tooltip":"",sortable:""}),t(b,{label:"大小",width:"120",sortable:"","sort-by":a=>a.size},{default:o(({row:a})=>[V(d(v(a.size)),1)]),_:1},8,["sort-by"]),t(b,{prop:"ext",label:"类型",width:"100",sortable:""})]),_:1},8,["data"]),_.value?(m(),y("div",de," 共找到 "+d(_.value.count)+" 个大文件 ",1)):q("",!0)]),_:1})])}}}),he=ae(pe,[["__scopeId","data-v-5ab34f1a"]]);export{he as default};
